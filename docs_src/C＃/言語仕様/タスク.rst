======
タスク
======

戻り値のあるTaskの例
====================

  .. code-block:: csharp

    var taskList = new List<Task<bool>>();
    // 追加されたデバイスに接続する（COM番号を書込む）
    foreach (var device in deviceList)
    {
        Task<bool> task = Task.Run(() =>
        {
            if(!device.Connect(deviceInfo.ComNum)) return false;
            if(device.SendRequest_IDParamRead(true) != ResponseResults.OK) return false;
            return true;
        });
        taskList.Add(task);
    }
    await Task.WhenAll(taskList);

    if(taskList.Where(x => x.Result == false).Count() != 0)
    {
        return false;
    }
    else
    {
        return true;
    }

戻り値のあるTaskの例2（複数のタスク結果に各々名前をつける）
===========================================================

  .. code-block:: csharp

    var taskList = new List<Task<(int comNum, bool result, IDParam idParam)>>();
    foreach(var comNum in comNumList)
    {
        Task<(int, bool, IDParam)> task = Task.Run(() =>
        {
            var deviceCom = new DeviceCommunication(1);     // デバイスIDは仮IDでOK
            if (!deviceCom.Connect(comNum, true, false))
            {
                return (comNum, false, null);
            }
            var res = deviceCom.SendRequest_IDParamRead(true);
            deviceCom.Disconnect(false);

            // 通信NGの場合
            if ((res == ResponseResults.Disconnected)
                || (res == ResponseResults.ResponseTimeout))
            {
                return (comNum, false, null);
            }
            else
            {
                return (comNum, true, deviceCom.IDParam);
            }
        });
        taskList.Add(task);
    }
    await Task.WhenAll(taskList);
